

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lore_sa.surrogate.Surrogate &mdash; LORE_sa  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  
      <script src="../../_static/jquery.js"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
      <script src="../../_static/doctools.js"></script>
      <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="lore_sa.surrogate.DecisionTreeSurrogate" href="lore_sa.surrogate.DecisionTreeSurrogate.html" />
    <link rel="prev" title="lore_sa.rule.Expression" href="lore_sa.rule.Expression.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            LORE_sa
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../get_started.html">Get started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#welcome-to-lore-sa">Welcome to LORE_sa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#what-is-lore">What is LORE?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#using-virtualenv">Using virtualenv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#using-conda">Using conda</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#quick-start">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#basic-usage">Basic Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#key-components">Key Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#choosing-an-explainer">Choosing an Explainer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#tabularrandomgeneratorlore">TabularRandomGeneratorLore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#tabulargeneticgeneratorlore">TabularGeneticGeneratorLore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#tabularrandgengeneratorlore">TabularRandGenGeneratorLore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#understanding-the-explanation">Understanding the Explanation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#rule">Rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#counterfactuals">Counterfactuals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#deltas">Deltas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#feature-importances">Feature Importances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../get_started.html#fidelity">Fidelity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#common-pitfalls">Common Pitfalls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture.html">Architecture and Methodology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#theoretical-foundation">Theoretical Foundation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#the-four-stage-process">The Four-Stage Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#stage-1-instance-encoding">Stage 1: Instance Encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#stage-2-neighborhood-generation">Stage 2: Neighborhood Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#stage-3-surrogate-training">Stage 3: Surrogate Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#stage-4-rule-extraction">Stage 4: Rule Extraction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#architecture-components">Architecture Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#black-box-wrapper-abstractbbox">Black Box Wrapper (AbstractBBox)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#dataset-tabulardataset">Dataset (TabularDataset)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#encoder-decoder-encdec">Encoder/Decoder (EncDec)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#neighborhood-generator-neighborhoodgenerator">Neighborhood Generator (NeighborhoodGenerator)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#surrogate-model-surrogate">Surrogate Model (Surrogate)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#rule-and-expression-classes">Rule and Expression Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#workflow-diagram">Workflow Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#choosing-num-instances">Choosing num_instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#interpreting-fidelity">Interpreting Fidelity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#handling-low-fidelity">Handling Low Fidelity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#feature-importance-interpretation">Feature Importance Interpretation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#computational-complexity">Computational Complexity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#time-complexity">Time Complexity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#space-complexity">Space Complexity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#typical-running-times">Typical Running Times</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#references">References</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#primary-paper">Primary Paper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#related-work">Related Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#key-differences-from-lime">Key Differences from LIME</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#implementation-notes">Implementation Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#memory-considerations">Memory Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture.html#reproducibility">Reproducibility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/tabular_explanations_example.html">Tabular explanation example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tabular_explanations_example.html#learning-and-explaining-german-credit-dataset">Learning and explaining German Credit Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tabular_explanations_example.html#loading-and-preparation-of-data">Loading and preparation of data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/tabular_explanations_example.html#learning-a-random-forest-classfier">Learning a Random Forest classfier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tabular_explanations_example.html#explaining-the-prediction">Explaining the prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/tabular_explanations_example.html#shap-explainer">SHAP explainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/tabular_explanations_example.html#lore-explainer">LORE explainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/tabular_explanations_example.html#lime-explainer">LIME explainer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tabular_explanations_example.html#learning-a-different-model">Learning a different model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/tabular_explanations_example.html#learning-a-logistic-regressor">Learning a Logistic Regressor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tabular_explanations_example.html#id1">Explaining the prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/tabular_explanations_example.html#id2">LORE explainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/tabular_explanations_example.html#id3">LIME explainer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../modules.html#lore-sa-bbox-blackbox-abstract-class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.bbox</span></code>: BlackBox abstract class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.bbox.AbstractBBox.html">lore_sa.bbox.AbstractBBox</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.bbox.AbstractBBox.html#lore_sa.bbox.AbstractBBox"><code class="docutils literal notranslate"><span class="pre">AbstractBBox</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#lore-sa-dataset-dataset-class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.dataset</span></code>: Dataset class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.dataset.Dataset.html">lore_sa.dataset.Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.dataset.Dataset.html#lore_sa.dataset.Dataset"><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.dataset.TabularDataset.html">lore_sa.dataset.TabularDataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.dataset.TabularDataset.html#lore_sa.dataset.TabularDataset"><code class="docutils literal notranslate"><span class="pre">TabularDataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.dataset.utils.html">lore_sa.dataset.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.dataset.utils.html#lore_sa.dataset.utils.prepare_bank_dataset"><code class="docutils literal notranslate"><span class="pre">prepare_bank_dataset()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#lore-sa-neighgen-neighborhood-generator-classes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.neighgen</span></code>: Neighborhood Generator classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.neighgen.RandomGenerator.html">lore_sa.neighgen.RandomGenerator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.neighgen.RandomGenerator.html#lore_sa.neighgen.RandomGenerator"><code class="docutils literal notranslate"><span class="pre">RandomGenerator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.neighgen.GeneticGenerator.html">lore_sa.neighgen.GeneticGenerator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.neighgen.GeneticGenerator.html#lore_sa.neighgen.GeneticGenerator"><code class="docutils literal notranslate"><span class="pre">GeneticGenerator</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#lore-sa-discretizer-discretizer-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.discretizer</span></code>: Discretizer classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.discretizer.Discretizer.html">lore_sa.discretizer.Discretizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.discretizer.Discretizer.html#lore_sa.discretizer.Discretizer"><code class="docutils literal notranslate"><span class="pre">Discretizer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.discretizer.RMEPDiscretizer.html">lore_sa.discretizer.RMEPDiscretizer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.discretizer.RMEPDiscretizer.html#lore_sa.discretizer.RMEPDiscretizer"><code class="docutils literal notranslate"><span class="pre">RMEPDiscretizer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#lore-sa-encoder-decoder-encoder-decoder-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.encoder_decoder</span></code>: Encoder/Decoder classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.encoder_decoder.EncDec.html">lore_sa.encoder_decoder.EncDec</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.encoder_decoder.EncDec.html#lore_sa.encoder_decoder.EncDec"><code class="docutils literal notranslate"><span class="pre">EncDec</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.encoder_decoder.ColumnTransformerEnc.html">lore_sa.encoder_decoder.ColumnTransformerEnc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.encoder_decoder.ColumnTransformerEnc.html#lore_sa.encoder_decoder.ColumnTransformerEnc"><code class="docutils literal notranslate"><span class="pre">ColumnTransformerEnc</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#lore-sa-explanation-explanation-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.explanation</span></code>: Explanation classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.explanation.Explanation.html">lore_sa.explanation.Explanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.explanation.Explanation.html#lore_sa.explanation.Explanation"><code class="docutils literal notranslate"><span class="pre">Explanation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.explanation.ExplanationEncoder.html">lore_sa.explanation.ExplanationEncoder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.explanation.ExplanationEncoder.html#lore_sa.explanation.ExplanationEncoder"><code class="docutils literal notranslate"><span class="pre">ExplanationEncoder</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.explanation.ImageExplanation.html">lore_sa.explanation.ImageExplanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.explanation.ImageExplanation.html#lore_sa.explanation.ImageExplanation"><code class="docutils literal notranslate"><span class="pre">ImageExplanation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.explanation.MultilabelExplanation.html">lore_sa.explanation.MultilabelExplanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.explanation.MultilabelExplanation.html#lore_sa.explanation.MultilabelExplanation"><code class="docutils literal notranslate"><span class="pre">MultilabelExplanation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.explanation.TextExplanation.html">lore_sa.explanation.TextExplanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.explanation.TextExplanation.html#lore_sa.explanation.TextExplanation"><code class="docutils literal notranslate"><span class="pre">TextExplanation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.explanation.json2explanation.html">lore_sa.explanation.json2explanation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.explanation.json2explanation.html#lore_sa.explanation.json2explanation"><code class="docutils literal notranslate"><span class="pre">json2explanation()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#lore-sa-rule-rule-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.rule</span></code>: Rule classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.rule.Rule.html">lore_sa.rule.Rule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.rule.Rule.html#lore_sa.rule.Rule"><code class="docutils literal notranslate"><span class="pre">Rule</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.rule.RuleEncoder.html">lore_sa.rule.RuleEncoder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.rule.RuleEncoder.html#lore_sa.rule.RuleEncoder"><code class="docutils literal notranslate"><span class="pre">RuleEncoder</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.rule.json2rule.html">lore_sa.rule.json2rule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.rule.json2rule.html#lore_sa.rule.json2rule"><code class="docutils literal notranslate"><span class="pre">json2rule()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.rule.json2expression.html">lore_sa.rule.json2expression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.rule.json2expression.html#lore_sa.rule.json2expression"><code class="docutils literal notranslate"><span class="pre">json2expression()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.rule.Expression.html">lore_sa.rule.Expression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.rule.Expression.html#lore_sa.rule.Expression"><code class="docutils literal notranslate"><span class="pre">Expression</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../modules.html#lore-sa-surrogate-surrogate-classes-and-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.surrogate</span></code>: Surrogate classes and functions</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">lore_sa.surrogate.Surrogate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lore_sa.surrogate.Surrogate"><code class="docutils literal notranslate"><span class="pre">Surrogate</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.surrogate.DecisionTreeSurrogate.html">lore_sa.surrogate.DecisionTreeSurrogate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.surrogate.DecisionTreeSurrogate.html#lore_sa.surrogate.DecisionTreeSurrogate"><code class="docutils literal notranslate"><span class="pre">DecisionTreeSurrogate</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html#lore-sa-util-util-functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lore_sa.util</span></code>: Util functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lore_sa.util.html">lore_sa.util</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.util.html#lore_sa.util.best_fit_distribution"><code class="docutils literal notranslate"><span class="pre">best_fit_distribution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.util.html#lore_sa.util.sigmoid"><code class="docutils literal notranslate"><span class="pre">sigmoid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="lore_sa.util.html#lore_sa.util.vector2dict"><code class="docutils literal notranslate"><span class="pre">vector2dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">LORE_sa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../modules.html">Modules</a></li>
      <li class="breadcrumb-item active">lore_sa.surrogate.Surrogate</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/source/generated/lore_sa.surrogate.Surrogate.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lore-sa-surrogate-surrogate">
<h1>lore_sa.surrogate.Surrogate<a class="headerlink" href="#lore-sa-surrogate-surrogate" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="lore_sa.surrogate.Surrogate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lore_sa.surrogate.</span></span><span class="sig-name descname"><span class="pre">Surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lore_sa/surrogate/surrogate.html#Surrogate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lore_sa.surrogate.Surrogate" title="Permalink to this definition"></a></dt>
<dd><p>Abstract base class for interpretable surrogate models.</p>
<p>A surrogate model is an interpretable machine learning model (like a decision tree)
that approximates the behavior of a complex black box model in a local region around
a specific instance. LORE uses surrogates to extract interpretable rules that explain
black box predictions.</p>
<p>The surrogate model is trained on a synthetic neighborhood of instances generated
around the instance to explain, with labels provided by the black box model. This
creates a local approximation that is both accurate and interpretable.</p>
<p>Key responsibilities:
1. Train an interpretable model on the neighborhood
2. Extract factual rules explaining the prediction
3. Generate counterfactual rules showing alternative scenarios
4. Measure fidelity (how well it approximates the black box)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lore_sa.surrogate.Surrogate.kind">
<span class="sig-name descname"><span class="pre">kind</span></span><a class="headerlink" href="#lore_sa.surrogate.Surrogate.kind" title="Permalink to this definition"></a></dt>
<dd><p>Type of surrogate model (e.g., ‘decision_tree’, ‘supertree’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lore_sa.surrogate.Surrogate.preprocessing">
<span class="sig-name descname"><span class="pre">preprocessing</span></span><a class="headerlink" href="#lore_sa.surrogate.Surrogate.preprocessing" title="Permalink to this definition"></a></dt>
<dd><p>Preprocessing method to apply before training</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lore_sa.surrogate.Surrogate.fidelity">
<span class="sig-name descname"><span class="pre">fidelity</span></span><a class="headerlink" href="#lore_sa.surrogate.Surrogate.fidelity" title="Permalink to this definition"></a></dt>
<dd><p>Score indicating how well the surrogate approximates
the black box (computed during training)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lore_sa.surrogate.Surrogate.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lore_sa/surrogate/surrogate.html#Surrogate.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lore_sa.surrogate.Surrogate.train" title="Permalink to this definition"></a></dt>
<dd><p>Train the surrogate model on neighborhood data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lore_sa.surrogate.Surrogate.get_rule">
<span class="sig-name descname"><span class="pre">get_rule</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lore_sa/surrogate/surrogate.html#Surrogate.get_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lore_sa.surrogate.Surrogate.get_rule" title="Permalink to this definition"></a></dt>
<dd><p>Extract the decision rule for a specific instance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lore_sa.surrogate.Surrogate.get_counterfactual_rules">
<span class="sig-name descname"><span class="pre">get_counterfactual_rules</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lore_sa/surrogate/surrogate.html#Surrogate.get_counterfactual_rules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lore_sa.surrogate.Surrogate.get_counterfactual_rules" title="Permalink to this definition"></a></dt>
<dd><p>Generate counterfactual rules</p>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">lore_sa.surrogate</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeSurrogate</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate</span> <span class="o">=</span> <span class="n">DecisionTreeSurrogate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surrogate</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">neighborhood_X</span><span class="p">,</span> <span class="n">neighborhood_y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rule</span> <span class="o">=</span> <span class="n">surrogate</span><span class="o">.</span><span class="n">get_rule</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">encoder</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counterfactuals</span> <span class="o">=</span> <span class="n">surrogate</span><span class="o">.</span><span class="n">get_counterfactual_rules</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span>
<span class="gp">... </span>                                                      <span class="n">neighborhood_X</span><span class="p">,</span>
<span class="gp">... </span>                                                      <span class="n">neighborhood_y</span><span class="p">,</span>
<span class="gp">... </span>                                                      <span class="n">encoder</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>DecisionTreeSurrogate: Concrete implementation using scikit-learn decision trees</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="lore_sa.surrogate.Surrogate.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lore_sa/surrogate/surrogate.html#Surrogate.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lore_sa.surrogate.Surrogate.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of surrogate model (e.g., ‘decision_tree’, ‘supertree’)</p></li>
<li><p><strong>preprocessing</strong> (<em>optional</em>) – Preprocessing method to apply to the data before training</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lore_sa.surrogate.Surrogate.__init__" title="lore_sa.surrogate.Surrogate.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>([kind, preprocessing])</p></td>
<td><p>Initialize the surrogate model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id0" title="lore_sa.surrogate.Surrogate.get_counterfactual_rules"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_counterfactual_rules</span></code></a>(x, ...[, encoder, ...])</p></td>
<td><p>Generate counterfactual rules showing alternative scenarios.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id1" title="lore_sa.surrogate.Surrogate.get_rule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_rule</span></code></a>(x[, encdec])</p></td>
<td><p>Extract the decision rule for a specific instance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id2" title="lore_sa.surrogate.Surrogate.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(Z, Yb, weights)</p></td>
<td><p>Train the surrogate model on neighborhood data.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_counterfactual_rules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_train_X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_train_Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="lore_sa.encoder_decoder.EncDec.html#lore_sa.encoder_decoder.EncDec" title="lore_sa.encoder_decoder.enc_dec.EncDec"><span class="pre">EncDec</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_crules</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unadmittible_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lore_sa/surrogate/surrogate.html#Surrogate.get_counterfactual_rules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>Generate counterfactual rules showing alternative scenarios.</p>
<p>Counterfactual rules describe what changes to the instance would result in a
different prediction. They answer “what if” questions like: “What if the age
was lower? Would the prediction change?”</p>
<p>This method finds paths in the surrogate model that lead to different classes
and extracts the minimal changes (deltas) needed to reach those predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – Instance to explain, in encoded space, shape (n_encoded_features,)</p></li>
<li><p><strong>neighborhood_train_X</strong> (<em>np.array</em>) – Neighborhood instances in encoded space,
shape (n_samples, n_encoded_features)</p></li>
<li><p><strong>neighborhood_train_Y</strong> (<em>np.array</em>) – Labels for neighborhood instances from the
black box, shape (n_samples,)</p></li>
<li><p><strong>encoder</strong> (<a class="reference internal" href="lore_sa.encoder_decoder.EncDec.html#lore_sa.encoder_decoder.EncDec" title="lore_sa.encoder_decoder.EncDec"><em>EncDec</em></a><em>, </em><em>optional</em>) – Encoder/decoder for converting rules to original space</p></li>
<li><p><strong>filter_crules</strong> (<em>optional</em>) – Function to filter counterfactual rules</p></li>
<li><p><strong>constraints</strong> (<em>dict</em><em>, </em><em>optional</em>) – Constraints on which features can be changed</p></li>
<li><p><strong>unadmittible_features</strong> (<em>list</em><em>, </em><em>optional</em>) – List of features that cannot be
changed (e.g., immutable features like age, gender)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(counterfactual_rules, deltas) where:</dt><dd><ul class="simple">
<li><p>counterfactual_rules (list): List of Rule objects for different classes</p></li>
<li><p>deltas (list): List of lists of Expression objects showing minimal
changes needed for each counterfactual</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crules</span><span class="p">,</span> <span class="n">deltas</span> <span class="o">=</span> <span class="n">surrogate</span><span class="o">.</span><span class="n">get_counterfactual_rules</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">encoded_instance</span><span class="p">,</span> <span class="n">neighborhood_X</span><span class="p">,</span> <span class="n">neighborhood_y</span><span class="p">,</span> <span class="n">encoder</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Counterfactual: </span><span class="si">{</span><span class="n">crules</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changes needed: </span><span class="si">{</span><span class="n">deltas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go"># Changes needed: [age &gt;= 40, income &gt; 60000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encdec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="lore_sa.encoder_decoder.EncDec.html#lore_sa.encoder_decoder.EncDec" title="lore_sa.encoder_decoder.enc_dec.EncDec"><span class="pre">EncDec</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lore_sa/surrogate/surrogate.html#Surrogate.get_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Permalink to this definition"></a></dt>
<dd><p>Extract the decision rule for a specific instance.</p>
<p>This method traverses the trained surrogate model to extract the decision rule
that applies to the given instance. The rule describes the conditions (premises)
that lead to the predicted class (consequence).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – Instance to explain, in encoded space, shape (n_encoded_features,)</p></li>
<li><p><strong>encdec</strong> (<a class="reference internal" href="lore_sa.encoder_decoder.EncDec.html#lore_sa.encoder_decoder.EncDec" title="lore_sa.encoder_decoder.EncDec"><em>EncDec</em></a><em>, </em><em>optional</em>) – Encoder/decoder to convert the rule back to
original feature space for interpretability</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Rule object containing premises (conditions) and consequence (prediction)</dt><dd><p>that explain why the surrogate (and by extension, the black box) predicts
a specific class for this instance</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="lore_sa.rule.Rule.html#lore_sa.rule.Rule" title="lore_sa.rule.Rule">Rule</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rule</span> <span class="o">=</span> <span class="n">surrogate</span><span class="o">.</span><span class="n">get_rule</span><span class="p">(</span><span class="n">encoded_instance</span><span class="p">,</span> <span class="n">encoder</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
<span class="go"># Output: IF age &gt; 30 AND income &lt;= 50000 THEN class = 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Yb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/lore_sa/surrogate/surrogate.html#Surrogate.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition"></a></dt>
<dd><p>Train the surrogate model on neighborhood data.</p>
<p>This method trains the interpretable surrogate model on a synthetic neighborhood
of instances, where the labels are provided by the black box model. The goal is
to create a local approximation that captures the black box’s decision boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Z</strong> (<em>np.array</em>) – Training data in encoded space, shape (n_samples, n_encoded_features).
These are the synthetic instances generated around the instance to explain.</p></li>
<li><p><strong>Yb</strong> (<em>np.array</em>) – Target labels from the black box model, shape (n_samples,).
These are the predictions made by the black box on the neighborhood.</p></li>
<li><p><strong>weights</strong> (<em>np.array</em><em>, </em><em>optional</em>) – Sample weights for training, shape (n_samples,).
Can be used to emphasize certain instances in the neighborhood.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The fidelity of the surrogate is typically computed during training to assess
how well it approximates the black box model in the local neighborhood.</p>
</div>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lore_sa.rule.Expression.html" class="btn btn-neutral float-left" title="lore_sa.rule.Expression" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lore_sa.surrogate.DecisionTreeSurrogate.html" class="btn btn-neutral float-right" title="lore_sa.surrogate.DecisionTreeSurrogate" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Kode srl.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>